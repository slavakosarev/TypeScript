import { HttpHelper } from "../../utils/http-helper.js";
import { Place } from "../../domain/place.js";
export class HomyProvider {
    search(query) {
        return HttpHelper.fetchAsJson(HomyProvider.apiUrl + '/places?' +
            this.convertFilterToQueryString(query))
            .then((response) => {
            return this.convertFlatListResponse(response);
        })
            .catch((err) => {
            throw new Error(err);
        });
    }
    convertFilterToQueryString(filter) {
        let urlString = `&checkInDate=${this.dateToUnixStamp(filter.checkInDate)}` +
            `&checkOutDate=${this.dateToUnixStamp(filter.checkOutDate)}` +
            `&coordinates=${filter.city}`;
        if (filter.priceLimit != null) {
            urlString += `&maxPrice=${filter.priceLimit}`;
        }
        return urlString;
    }
    dateToUnixStamp(date) {
        return date.getTime() / 1000;
    }
    convertFlatListResponse(response) {
        return response.map((item) => {
            return this.convertFlatResponse(item);
        });
    }
    convertFlatResponse(item) {
        return new Place(HomyProvider.provider, item.id, item.image, item.name, item.description, item.remoteness, item.price, item.bookedDates, []);
    }
}
HomyProvider.provider = 'homyrent';
HomyProvider.apiUrl = 'http://localhost:3030';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaG9teS1wcm92aWRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9zdG9yZS9wcm92aWRlcnMvaG9teS9ob215LXByb3ZpZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQTtBQUV2RCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sdUJBQXVCLENBQUE7QUFFN0MsTUFBTSxPQUFPLFlBQVk7SUFLaEIsTUFBTSxDQUFDLEtBQW1CO1FBRS9CLE9BQU8sVUFBVSxDQUFDLFdBQVcsQ0FDM0IsWUFBWSxDQUFDLE1BQU0sR0FBRyxVQUFVO1lBQ2hDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxLQUFLLENBQUMsQ0FDdkM7YUFDRSxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUNqQixPQUFPLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxRQUFRLENBQUMsQ0FBQTtRQUMvQyxDQUFDLENBQUM7YUFDRCxLQUFLLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtZQUNiLE1BQU0sSUFBSSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDdEIsQ0FBQyxDQUFDLENBQUE7SUFFTixDQUFDO0lBRU8sMEJBQTBCLENBQUMsTUFBb0I7UUFDckQsSUFBSSxTQUFTLEdBQUcsZ0JBQWdCLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQ3hFLGlCQUFpQixJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsRUFBRTtZQUM1RCxnQkFBZ0IsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFBO1FBRS9CLElBQUksTUFBTSxDQUFDLFVBQVUsSUFBSSxJQUFJLEVBQUU7WUFDN0IsU0FBUyxJQUFJLGFBQWEsTUFBTSxDQUFDLFVBQVUsRUFBRSxDQUFBO1NBQzlDO1FBRUQsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVPLGVBQWUsQ0FBQyxJQUFVO1FBQ2hDLE9BQU8sSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQTtJQUM5QixDQUFDO0lBR08sdUJBQXVCLENBQUMsUUFBZ0I7UUFDOUMsT0FBTyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDM0IsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDdkMsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBRU8sbUJBQW1CLENBQUMsSUFBVTtRQUNwQyxPQUFPLElBQUksS0FBSyxDQUNkLFlBQVksQ0FBQyxRQUFRLEVBQ3JCLElBQUksQ0FBQyxFQUFFLEVBQ1AsSUFBSSxDQUFDLEtBQUssRUFDVixJQUFJLENBQUMsSUFBSSxFQUNULElBQUksQ0FBQyxXQUFXLEVBQ2hCLElBQUksQ0FBQyxVQUFVLEVBQ2YsSUFBSSxDQUFDLEtBQUssRUFDVixJQUFJLENBQUMsV0FBVyxFQUNoQixFQUFFLENBQ0gsQ0FBQTtJQUNILENBQUM7O0FBckRhLHFCQUFRLEdBQUcsVUFBVSxDQUFBO0FBQ3BCLG1CQUFNLEdBQUcsdUJBQXVCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcm92aWRlciB9IGZyb20gXCIuLi8uLi9kb21haW4vcHJvdmlkZXIuanNcIlxuaW1wb3J0IHsgU2VhcmNoRmlsdGVyIH0gZnJvbSBcIi4uLy4uL2RvbWFpbi9zZWFyY2gtZmlsdGVyLmpzXCJcbmltcG9ydCB7IEh0dHBIZWxwZXIgfSBmcm9tIFwiLi4vLi4vdXRpbHMvaHR0cC1oZWxwZXIuanNcIlxuaW1wb3J0IHsgRmxhdCB9IGZyb20gXCIuL3Jlc3BvbnNlLmpzXCJcbmltcG9ydCB7IFBsYWNlIH0gZnJvbSBcIi4uLy4uL2RvbWFpbi9wbGFjZS5qc1wiXG5cbmV4cG9ydCBjbGFzcyBIb215UHJvdmlkZXIgaW1wbGVtZW50cyBQcm92aWRlciB7XG5cbiAgcHVibGljIHN0YXRpYyBwcm92aWRlciA9ICdob215cmVudCdcbiAgcHJpdmF0ZSBzdGF0aWMgYXBpVXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAzMCdcblxuICBwdWJsaWMgc2VhcmNoKHF1ZXJ5OiBTZWFyY2hGaWx0ZXIpOiBQcm9taXNlPFBsYWNlW10+IHtcblxuICAgIHJldHVybiBIdHRwSGVscGVyLmZldGNoQXNKc29uPEZsYXRbXT4oXG4gICAgICBIb215UHJvdmlkZXIuYXBpVXJsICsgJy9wbGFjZXM/JyArXG4gICAgICB0aGlzLmNvbnZlcnRGaWx0ZXJUb1F1ZXJ5U3RyaW5nKHF1ZXJ5KVxuICAgIClcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0RmxhdExpc3RSZXNwb25zZShyZXNwb25zZSlcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyKVxuICAgICAgfSlcblxuICB9XG5cbiAgcHJpdmF0ZSBjb252ZXJ0RmlsdGVyVG9RdWVyeVN0cmluZyhmaWx0ZXI6IFNlYXJjaEZpbHRlcik6IHN0cmluZyB7XG4gICAgbGV0IHVybFN0cmluZyA9IGAmY2hlY2tJbkRhdGU9JHt0aGlzLmRhdGVUb1VuaXhTdGFtcChmaWx0ZXIuY2hlY2tJbkRhdGUpfWAgK1xuICAgICAgYCZjaGVja091dERhdGU9JHt0aGlzLmRhdGVUb1VuaXhTdGFtcChmaWx0ZXIuY2hlY2tPdXREYXRlKX1gICtcbiAgICAgIGAmY29vcmRpbmF0ZXM9JHtmaWx0ZXIuY2l0eX1gXG5cbiAgICBpZiAoZmlsdGVyLnByaWNlTGltaXQgIT0gbnVsbCkge1xuICAgICAgdXJsU3RyaW5nICs9IGAmbWF4UHJpY2U9JHtmaWx0ZXIucHJpY2VMaW1pdH1gXG4gICAgfVxuXG4gICAgcmV0dXJuIHVybFN0cmluZztcbiAgfVxuXG4gIHByaXZhdGUgZGF0ZVRvVW5peFN0YW1wKGRhdGU6IERhdGUpIHtcbiAgICByZXR1cm4gZGF0ZS5nZXRUaW1lKCkgLyAxMDAwXG4gIH1cblxuXG4gIHByaXZhdGUgY29udmVydEZsYXRMaXN0UmVzcG9uc2UocmVzcG9uc2U6IEZsYXRbXSk6IFBsYWNlW10ge1xuICAgIHJldHVybiByZXNwb25zZS5tYXAoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRGbGF0UmVzcG9uc2UoaXRlbSlcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBjb252ZXJ0RmxhdFJlc3BvbnNlKGl0ZW06IEZsYXQpOiBQbGFjZSB7XG4gICAgcmV0dXJuIG5ldyBQbGFjZShcbiAgICAgIEhvbXlQcm92aWRlci5wcm92aWRlcixcbiAgICAgIGl0ZW0uaWQsXG4gICAgICBpdGVtLmltYWdlLFxuICAgICAgaXRlbS5uYW1lLFxuICAgICAgaXRlbS5kZXNjcmlwdGlvbixcbiAgICAgIGl0ZW0ucmVtb3RlbmVzcyxcbiAgICAgIGl0ZW0ucHJpY2UsXG4gICAgICBpdGVtLmJvb2tlZERhdGVzLFxuICAgICAgW10sXG4gICAgKVxuICB9XG59XG4iXX0=